<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>TyporaX-AI - AI Language Coach</title>

    <!-- PWA Manifest -->
    <link rel="manifest" href="/static/manifest.json">

    <!-- Icons and Theme -->
    <link rel="icon" type="image/x-icon" href="/static/images/icon.ico">
    <link rel="shortcut icon" type="image/x-icon" href="/static/images/icon.ico">
    <link rel="apple-touch-icon" href="/static/images/icon.ico">
    <meta name="theme-color" content="#007acc">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="TyporaX-AI">

    <!-- Styles -->
    <link rel="stylesheet" href="/static/vscode.css?v=1.1">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@vscode/codicons@latest/dist/codicon.css" />
</head>

<body>
    <!-- Activity Bar (Left-most sidebar) -->
    <div class="activity-bar">
        <div class="activity-item active" data-panel="profile" title="User Profile">
            <i class="codicon codicon-account"></i>
        </div>
        <div class="activity-item" data-panel="lessons" title="Lesson Generator">
            <i class="codicon codicon-notebook"></i>
        </div>
        <div class="activity-item" data-panel="progress" title="Progress">
            <i class="codicon codicon-graph"></i>
        </div>
        <div class="activity-item" data-panel="resources" title="Resources">
            <i class="codicon codicon-cloud-download"></i>
        </div>
        <div class="activity-spacer"></div>
        <div class="activity-item" data-panel="settings" title="Settings">
            <i class="codicon codicon-settings-gear"></i>
        </div>
    </div>

    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-header">
            <h3><i class="codicon codicon-account"></i> USER PROFILE</h3>
        </div>
        <div class="sidebar-content" id="profile-content">
            <div class="form-group">
                <label for="user_id">
                    <i class="codicon codicon-tag"></i> Your Name or ID
                </label>
                <input type="text" id="user_id" placeholder="e.g., John, alex, yusup...">
                <div class="hint">Used to save and load your settings</div>
            </div>

            <div class="form-group">
                <div class="status-box" id="profile_status">
                    Enter name to load profile
                </div>
            </div>

            <div class="section-divider"></div>

            <div class="section-title">
                <i class="codicon codicon-person"></i> PERSONAL PROFILE
            </div>

            <div class="form-group">
                <label for="ancestry">
                    <i class="codicon codicon-globe"></i> Ancestry Background
                </label>
                <select id="ancestry">
                    <option value="EUR">üåç European</option>
                    <option value="EAS" selected>üåè East Asian</option>
                    <option value="SAS">üåè South Asian</option>
                    <option value="AFR">üåç African</option>
                    <option value="AMR">üåé American</option>
                    <option value="MENA">üåç Middle Eastern/North African</option>
                    <option value="OTH">üåê Other</option>
                </select>
            </div>

            <div class="form-group">
                <label for="mbti">
                    <i class="codicon codicon-symbol-misc"></i> Personality Type (MBTI)
                </label>
                <select id="mbti">
                    <option value="INTJ" selected>INTJ</option>
                    <option value="INTP">INTP</option>
                    <option value="ENTJ">ENTJ</option>
                    <option value="ENTP">ENTP</option>
                    <option value="INFJ">INFJ</option>
                    <option value="INFP">INFP</option>
                    <option value="ENFJ">ENFJ</option>
                    <option value="ENFP">ENFP</option>
                    <option value="ISTJ">ISTJ</option>
                    <option value="ISFJ">ISFJ</option>
                    <option value="ESTJ">ESTJ</option>
                    <option value="ESFJ">ESFJ</option>
                    <option value="ISTP">ISTP</option>
                    <option value="ISFP">ISFP</option>
                    <option value="ESTP">ESTP</option>
                    <option value="ESFP">ESFP</option>
                </select>
            </div>

            <div class="section-divider"></div>

            <div class="section-title">
                <i class="codicon codicon-symbol-namespace"></i> LANGUAGE PREFERENCE
            </div>

            <div class="form-group">
                <label for="target_language">
                    <i class="codicon codicon-symbol-namespace"></i> Target Language
                </label>
                <select id="target_language">
                    <option value="japanese" selected>üáØüáµ Japanese (Êó•Êú¨Ë™û)</option>
                    <option value="dutch">üá≥üá± Dutch (Nederlands)</option>
                    <option value="chinese">üá®üá≥ Chinese (‰∏≠Êñá)</option>
                </select>
            </div>
        </div>

        <!-- Lesson Generator Content (hidden by default) -->
        <div class="sidebar-content" id="lessons-content" style="display: none;">
            <div class="section-title">
                <i class="codicon codicon-book"></i> LESSON GENERATOR
            </div>

            <div class="form-group">
                <label for="log_text">
                    <i class="codicon codicon-calendar"></i> Today's Activities
                </label>
                <textarea id="log_text" rows="3"
                    placeholder="e.g., Had coffee with friends, watched anime...">Dutch languge, Learning, Method, Anki</textarea>
                <div class="hint">What did you do today? (for context-based lessons)</div>
            </div>

            <div class="section-divider"></div>

            <div class="section-title">
                <i class="codicon codicon-info"></i> LEARNING STATUS
            </div>

            <div class="form-group">
                <div class="status-box" id="learning_method_status">
                    Your personalized learning method will be generated based on your profile
                </div>
            </div>

            <button class="btn-primary" id="generateLessonBtn">
                <i class="codicon codicon-mortar-board"></i> Generate Today's Lesson
            </button>
        </div>

        <!-- Learning Content (hidden by default) -->
        <div class="sidebar-content" id="progress-content" style="display: none;">
            <div class="section-title">
                <i class="codicon codicon-mortar-board"></i> LEARNING PROGRESS
            </div>

            <div class="progress-item">
                <div class="progress-label">Current User:</div>
                <div class="progress-value" id="current_user">Not logged in</div>
            </div>

            <div class="progress-item">
                <div class="progress-label">Target Language:</div>
                <div class="progress-value" id="current_language">Japanese</div>
            </div>

            <div class="section-divider"></div>

            <div class="section-title">
                <i class="codicon codicon-graph-line"></i> SESSION STATS
            </div>

            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-number">0</div>
                    <div class="stat-label">Messages Today</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">0</div>
                    <div class="stat-label">Experts Talked</div>
                </div>
            </div>
        </div>

        <!-- Progress Content (hidden by default) -->
        <div class="sidebar-content" id="progress-content" style="display: none;">
            <div class="section-title">
                <i class="codicon codicon-trophy"></i> ACHIEVEMENTS
            </div>

            <div class="achievement-item">
                <i class="codicon codicon-star-full"></i>
                <div class="achievement-text">
                    <div class="achievement-title">First Steps</div>
                    <div class="achievement-desc">Started learning journey</div>
                </div>
            </div>

            <div class="section-divider"></div>

            <div class="section-title">
                <i class="codicon codicon-calendar"></i> WEEKLY PROGRESS
            </div>

            <div class="progress-chart">
                <div class="chart-placeholder">
                    <i class="codicon codicon-graph"></i>
                    <p>Start chatting to see progress</p>
                </div>
            </div>
        </div>

        <!-- Resources Content (hidden by default) -->
        <div class="sidebar-content" id="resources-content" style="display: none;">
            <div class="section-title">
                <i class="codicon codicon-file-pdf"></i> PDF REPORT
            </div>
            <div id="pdf_output">
                <p class="output-text">Generate your learning plan to download the complete PDF report</p>
            </div>

            <div class="section-divider"></div>

            <div class="section-title">
                <i class="codicon codicon-layers"></i> ANKI DECK
            </div>
            <div id="anki_output">
                <p class="output-text">Your Anki flashcard deck will be available here for spaced repetition practice
                </p>
            </div>

            <div class="section-divider"></div>

            <div class="section-title">
                <i class="codicon codicon-unmute"></i> AUDIO GUIDE
            </div>
            <div id="audio_output">
                <p class="output-text">Pronunciation audio will be available here</p>
            </div>

            <div class="section-divider"></div>

            <div class="section-title">
                <i class="codicon codicon-link"></i> USEFUL LINKS
            </div>

            <div class="link-item">
                <a href="#" class="resource-link">
                    <i class="codicon codicon-link-external"></i> Dutch Grammar Guide
                </a>
            </div>

            <div class="link-item">
                <a href="#" class="resource-link">
                    <i class="codicon codicon-link-external"></i> Pronunciation Practice
                </a>
            </div>
        </div>

        <!-- Settings Content (hidden by default) -->
        <div class="sidebar-content" id="settings-content" style="display: none;">
            <div class="section-title">
                <i class="codicon codicon-symbol-color"></i> APPEARANCE
            </div>

            <div class="form-group">
                <label for="theme_select">
                    <i class="codicon codicon-color-mode"></i> Theme
                </label>
                <select id="theme_select">
                    <option value="dark">Dark Theme</option>
                    <option value="light">Light Theme</option>
                    <option value="auto">Auto (System)</option>
                </select>
            </div>

            <div class="section-divider"></div>

            <div class="section-title">
                <i class="codicon codicon-unmute"></i> AUDIO SETTINGS
            </div>

            <div class="form-group">
                <label for="voice_speed">
                    <i class="codicon codicon-dashboard"></i> Speech Speed
                </label>
                <input type="range" id="voice_speed" min="0.5" max="2" step="0.1" value="1">
                <div class="hint">Current: Normal (1.0x)</div>
            </div>

            <div class="form-group">
                <div class="checkbox-group">
                    <input type="checkbox" id="auto_speak" checked>
                    <label for="auto_speak">Auto-speak expert responses</label>
                </div>
            </div>

            <div class="section-divider"></div>

            <div class="section-title">
                <i class="codicon codicon-database"></i> DATA
            </div>

            <button class="btn-secondary" id="clearDataBtn">
                <i class="codicon codicon-trash"></i> Clear All Data
            </button>
        </div>
    </div>

    <!-- Main Editor Area -->
    <div class="editor-container">
        <!-- Tabs -->
        <div class="editor-tabs">
            <div class="tab active" data-tab="experts">
                <i class="codicon codicon-organization"></i> Talk Experts
            </div>
            <div class="tab" data-tab="markdown">
                <i class="codicon codicon-file-code"></i> Markdown Editor
            </div>
            <div class="tab" data-tab="lesson">
                <i class="codicon codicon-book"></i> Today's Lesson
            </div>
            <div class="tab" data-tab="anki">
                <i class="codicon codicon-layers"></i> Anki Flashcards
            </div>
            <div class="tab" data-tab="plots">
                <i class="codicon codicon-graph"></i> Plots & Charts
            </div>
            <div class="tab" data-tab="overview">
                <i class="codicon codicon-home"></i> Overview
            </div>
        </div>

        <!-- Tab Content -->
        <div class="editor-content">
            <!-- Talk Experts Tab -->
            <div class="tab-content active" id="experts-content">
                <div class="chat-container">
                    <!-- Chat Header with Expert Selection -->
                    <div class="chat-header">
                        <h3><i class="codicon codicon-comment-discussion"></i> Praat met Nederlandse Experts</h3>
                        <div class="chat-controls">
                            <div class="expert-selector">
                                <label for="expertSelect">Expert:</label>
                                <select id="expertSelect">
                                    <option value="healthcare">üè• Nederlandse Zorgexpert</option>
                                    <option value="interview">üíª Nederlandse IT Coach</option>
                                    <option value="language">üåç Nederlandse Taalcoach</option>
                                    <option value="podcast">üéôÔ∏è Nederlandse Podcast (Emma & Daan)</option>
                                </select>
                            </div>
                            
                        </div>
                    </div>

                    <!-- Chat Messages Area -->
                    <div class="chat-messages" id="chatMessages">
                        <div class="chat-welcome">
                            <i class="codicon codicon-hubot"></i>
                            <h3>Welkom bij Nederlandse Expert Chat!</h3>
                            <p>Kies een expert hierboven en begin een gesprek in het Nederlands. Je kunt typen of spraak
                                gebruiken.</p>
                        </div>
                    </div>

                    <!-- Chat Input Container -->
                    <div class="chat-input-container">
                        <div class="chat-input-wrapper">
                            <textarea id="chatInput" class="chat-input" placeholder="Type your message here..."
                                rows="1"></textarea>
                            <div class="chat-controls">
                                <button class="btn-voice" id="voiceButton" title="Voice input">
                                    <i class="codicon codicon-mic"></i>
                                    <div class="voice-status inactive"></div>
                                </button>
                                <button class="btn-send" id="sendButton" title="Send message" disabled>
                                    <i class="codicon codicon-send"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Markdown Editor Tab -->
            <div class="tab-content" id="markdown-content">
                <div class="markdown-editor-container">
                    <div class="markdown-editor-panel">
                        <div class="panel-header">
                            <h3><i class="codicon codicon-edit"></i> Editor</h3>
                            <button class="btn-small" id="clearMarkdown" title="Clear editor">
                                <i class="codicon codicon-trash"></i>
                            </button>
                        </div>
                        <textarea id="markdownInput"
                            placeholder="# Write your markdown here...\n\nYou can use **bold**, *italic*, lists, and more!"></textarea>
                    </div>
                    <div class="markdown-preview-panel">
                        <div class="panel-header">
                            <h3><i class="codicon codicon-eye"></i> Preview</h3>
                        </div>
                        <div id="markdownPreview" class="markdown-preview">
                            <p class="output-text">Start typing in the editor to see the preview here...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Lesson Tab -->
            <div class="tab-content" id="lesson-content">
                <h2><i class="codicon codicon-book"></i> Today's Lesson</h2>
                <div class="card">
                    <h3><i class="codicon codicon-symbol-keyword"></i> Vocabulary List</h3>
                    <div id="words_detail" class="output-text">
                        No vocabulary loaded yet
                    </div>
                </div>
                <div class="card">
                    <h3><i class="codicon codicon-whole-word"></i> Practice Sentences</h3>
                    <div id="sentences_detail" class="output-text">
                        No sentences loaded yet
                    </div>
                </div>
            </div>

            <!-- Anki Flashcards Tab -->
            <div class="tab-content" id="anki-content">
                <h2><i class="codicon codicon-layers"></i> Anki Flashcards</h2>
                <div class="flashcard-controls">
                    <button class="btn-flashcard" id="prevCard" disabled>
                        <i class="codicon codicon-chevron-left"></i> Previous
                    </button>
                    <span class="card-counter" id="cardCounter">0 / 0</span>
                    <button class="btn-flashcard" id="nextCard" disabled>
                        Next <i class="codicon codicon-chevron-right"></i>
                    </button>
                </div>
                <div class="flashcard-container" id="flashcardContainer">
                    <div class="flashcard" id="flashcard">
                        <div class="flashcard-inner">
                            <div class="flashcard-front">
                                <div class="output-text">Generate your learning plan to see flashcards</div>
                            </div>
                            <div class="flashcard-back">
                                <div class="output-text">Answer will appear here</div>
                            </div>
                        </div>
                    </div>
                    <button class="btn-flip" id="flipCard">Click to Flip</button>
                </div>
            </div>

            <!-- Plots & Charts Tab -->
            <div class="tab-content" id="plots-content">
                <h2><i class="codicon codicon-graph"></i> Visualizations & Charts</h2>

                <!-- Progress Plots -->
                <div class="card">
                    <h3><i class="codicon codicon-graph-line"></i> Learning Progress</h3>
                    <div id="progress_plot_container">
                        <img id="progress_plot" style="display: none; max-width: 100%; border-radius: 8px;">
                        <div class="output-text" id="progress_plot_placeholder">
                            Progress visualization will appear here
                        </div>
                    </div>
                </div>

                <!-- Additional Charts -->
                <div class="card">
                    <h3><i class="codicon codicon-pie-chart"></i> Learning Analytics</h3>
                    <div id="learning_analytics" class="output-text">
                        Learning analytics and performance charts will appear here
                    </div>
                </div>
            </div>

            <!-- Overview Tab -->
            <div class="tab-content" id="overview-content">
                <div class="welcome-header">
                    <h1><i class="codicon codicon-mortar-board"></i> TyporaX-AI</h1>
                    <p>Your Personalized AI Language Learning Coach</p>
                </div>

                <div class="content-grid">
                    <div class="card">
                        <h3><i class="codicon codicon-target"></i> Recommended Study Method</h3>
                        <div id="method_output" class="output-text">
                            Your personalized study method will appear here
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Status Bar -->
    <div class="status-bar">
        <div class="status-left">
            <span id="status_message"><i class="codicon codicon-circle-filled"></i> Ready</span>
            <button class="status-btn" id="testAssessment" title="Toggle Live Assessment Panel">
                <i class="codicon codicon-graph-line"></i> Live Assessment
            </button>
        </div>
        <div class="status-right">
            <button class="status-btn" id="fullscreenToggle" title="Toggle Fullscreen (F11)"
                onclick="toggleFullscreen()">
                <i class="codicon codicon-screen-full"></i>
            </button>
            <button class="status-btn" id="installPWA" title="Install App" onclick="installPWA()"
                style="display: none;">
                <i class="codicon codicon-desktop-download"></i>
            </button>
            <!-- Status bar: User and language are shown in the sidebar progress panel instead -->
            <!-- Removed duplicate current_user and current_language spans to simplify status bar -->
        </div>
    </div>

    <!-- Assessment Panel (Floating Modal) -->
    <div class="assessment-panel" id="assessmentPanel">
        <div class="assessment-header">
            <h3><i class="codicon codicon-graph-line"></i> Live Assessment</h3>
            <button class="btn-close" id="closeAssessment" title="Close Assessment">
                <i class="codicon codicon-close"></i>
            </button>
        </div>

        <div class="assessment-content">
            <!-- Overall Score -->
            <div class="assessment-section">
                <h4><i class="codicon codicon-star-full"></i> Overall Performance</h4>
                <div class="score-display" id="overallScore">
                    <div class="score-circle">
                        <span class="score-number">-</span>
                        <span class="score-label">Score</span>
                    </div>
                    <div class="performance-level" id="performanceLevel">Begin een gesprek voor beoordeling</div>
                </div>
            </div>

            <!-- Language Analysis -->
            <div class="assessment-section">
                <h4><i class="codicon codicon-symbol-namespace"></i> Language Quality</h4>
                <div class="language-metrics" id="languageMetrics">
                    <div class="metric">
                        <span class="metric-label">Grammar:</span>
                        <div class="metric-bar">
                            <div class="metric-fill" data-metric="grammar"></div>
                        </div>
                        <span class="metric-score" id="grammarScore">-</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Fluency:</span>
                        <div class="metric-bar">
                            <div class="metric-fill" data-metric="fluency"></div>
                        </div>
                        <span class="metric-score" id="fluencyScore">-</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Vocabulary:</span>
                        <span class="vocabulary-level" id="vocabularyLevel">-</span>
                    </div>
                </div>
            </div>

            <!-- Grammar Corrections -->
            <div class="assessment-section" id="correctionsSection" style="display: none;">
                <h4><i class="codicon codicon-symbol-keyword"></i> Grammar Corrections</h4>
                <div class="corrections-container">
                    <div class="errors-found" id="errorsFound">
                        <h5>Errors Found:</h5>
                        <ul id="errorsList">
                            <li>Wacht op je volgende bericht...</li>
                        </ul>
                    </div>
                    <div class="corrections-suggested" id="correctionsSuggested">
                        <h5>Corrections:</h5>
                        <ul id="correctionsList">
                            <li>Verbeteringen verschijnen hier</li>
                        </ul>
                    </div>
                    <div class="improved-version" id="improvedVersion">
                        <h5><i class="codicon codicon-wand"></i> Better Version:</h5>
                        <div class="improved-text" id="improvedText">
                            Begin te typen voor een verbeterde versie...
                        </div>
                        <div class="explanation" id="explanation">
                            Uitleg verschijnt hier
                        </div>
                    </div>
                </div>
            </div>

            <!-- Real-time Hints -->
            <div class="assessment-section">
                <h4><i class="codicon codicon-lightbulb"></i> Live Hints</h4>
                <div class="hints-container" id="hintsContainer">
                    <div class="hint-category">
                        <h5>Language Tips:</h5>
                        <ul id="languageTips">
                            <li>Begin een gesprek met een expert</li>
                        </ul>
                    </div>
                    <div class="hint-category">
                        <h5>Conversation Tips:</h5>
                        <ul id="conversationTips">
                            <li>Praat Nederlands met de expert</li>
                        </ul>
                    </div>
                    <div class="hint-category">
                        <h5>Expert Tips:</h5>
                        <ul id="expertTips">
                            <li>Realtime feedback tijdens gesprek</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Learning Progress -->
            <div class="assessment-section">
                <h4><i class="codicon codicon-trophy"></i> Session Progress</h4>
                <div class="progress-stats" id="progressStats">
                    <div class="stat">
                        <span class="stat-value" id="messageCount">0</span>
                        <span class="stat-label">Messages</span>
                    </div>
                    <div class="stat">
                        <span class="stat-value" id="engagementLevel">-</span>
                        <span class="stat-label">Engagement</span>
                    </div>
                    <div class="stat">
                        <span class="stat-value" id="learningMomentum">-</span>
                        <span class="stat-label">Momentum</span>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="assessment-section">
                <h4><i class="codicon codicon-zap"></i> Quick Actions</h4>
                <div class="quick-actions">
                    <button class="btn-action" id="getHelpBtn">
                        <i class="codicon codicon-question"></i> Get Help
                    </button>
                    <button class="btn-action" id="practiceMoreBtn">
                        <i class="codicon codicon-refresh"></i> Practice More
                    </button>
                    <button class="btn-action" id="reviewErrorsBtn">
                        <i class="codicon codicon-warning"></i> Review Errors
                    </button>
                    <button class="btn-action" id="minimizeBtn">
                        <i class="codicon codicon-chevron-down"></i> Minimize
                    </button>
                </div>
            </div>
            <!-- Vertical resize handle -->
            <div class="assessment-resizer" id="assessmentResizer" title="Resize"></div>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>

</html>